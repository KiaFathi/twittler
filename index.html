<!DOCTYPE html>
<html>
  <head>
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
    <style>
      .tweet{
        float: center;
        width: 500px;
        border-size: 20px;
        border-style: solid;
        border-color: blue;
        border-radius: 20px;
        text-align: center;
        margin: auto;
      }
      .user{
        float:left;
        font-weight: bold;
        color:purple;
      }
      .msg{
        float:center;
        clear: both;
      }
      .time{
        float:right;
      }
      .header{
        color:blue;
        font-size:20px;
        font-weight: bold;
        text-align: left
        text-decoration:underline;
      }
      .main_title{
        font-size:40px;
        text-align: center;

      }
    </style>
  </head>
  <boddy>
    <script>
      //global state for which messages are displayed
      var state = 'all';

      var getTweets = function(args){
        $('.tweets').empty()
        var chosen_user = arguments[0];
        var index = streams.home.length - 1;
        var counter =0;
        while(counter <= 15 && index >= 0){ //made counter here because my pages got way too long and it was annoying
          var tweet = streams.home[index];
          var user = tweet.user;
          var timestamp = tweet.created_at
          if(chosen_user === user || chosen_user === 'all'){
            var $tweet = $("<div class='tweet " +tweet.user + "'></div>");
            $tweet.append("<p class='user'>" + "@" + tweet.user +'</p>');
            $tweet.append("<p class='time'>" + "Posted: " + timestamp + '</p>');
            $tweet.append("<p class='msg'>" + tweet.message + '</p>');
            $tweet.appendTo('.tweets');
          }
          index -= 1;
          counter++;
        }
        timeTweet(getTweets);
      };

      var timeTweet = function(callback){
        return setTimeout(function(){
          callback(state);
        }, 5000);
      }

      var stateChange = function(arg){
        var clicked = $(arg).text().slice(1);
        if(state != 'all'){
          state = 'all';
          console.log(state);
        }else{
          state = clicked;
          console.log(state);
        }
        getTweets(state);
      };


      

      $(document).ready(function(){
        $('.user').on('click',function(){
          stateChange(this);
         });
        $('.main_title').on('click', function(){
          location.reload();
        })
        getTweets(state);
      });

      

    </script>
    <div class='header'>
      <p class ="main_title">Twittler</p>
    </div>
    <div class='tweets'>
    </div>
  </body>
</html>
